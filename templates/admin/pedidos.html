{% extends "admin/base_admin.html" %}

{% block title %}Pedidos - Admin SolarPro{% endblock %}
{% block page_title %}Pedidos{% endblock %}
{% block header_icon %}ðŸ›’{% endblock %}

{% block extra_css %}
<style>
.filter-tabs {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    margin-bottom: 1.5rem;
}

.tab {
    padding: 0.75rem 1.25rem;
    border-radius: 8px;
    background: var(--white);
    border: 2px solid #e2e8f0;
    text-decoration: none;
    color: var(--dark-gray);
    font-weight: 600;
    font-size: 0.9rem;
    transition: var(--transition);
}

.tab:hover {
    border-color: var(--primary-green);
    background: rgba(11, 106, 74, 0.05);
}

.tab.active {
    background: var(--primary-green);
    color: var(--white);
    border-color: var(--primary-green);
}

@media (max-width: 768px) {
    .filter-tabs {
        gap: 0.5rem;
    }

    .tab {
        padding: 0.6rem 0.875rem;
        font-size: 0.8rem;
        flex: 1 1 auto;
        text-align: center;
        min-width: calc(50% - 0.25rem);
    }
}

@media (max-width: 480px) {
    .tab {
        min-width: 100%;
    }
}

/* Custom badge styles */
.status-badge {
    padding: 0.3em 0.6em;
    border-radius: 4px;
    font-weight: 600;
    font-size: 0.85em;
    text-transform: capitalize;
}

.status-aprovado {
    background-color: #d4edda;
    color: #155724;
}

.status-pendente {
    background-color: #fff3cd;
    color: #856404;
}

.status-pago {
    background-color: #cce5ff;
    color: #004085;
}

.status-processando {
    background-color: #cfe2f3;
    color: #0c5460;
}

.status-enviado {
    background-color: #d1ecf1;
    color: #0c5460;
}

.status-entregue {
    background-color: #d4edda;
    color: #155724;
}

.status-cancelado {
    background-color: #f8d7da;
    color: #721c24;
}
</style>
{% endblock %}

{% block content %}
<div class="page-actions">
    <div class="filter-tabs">
        <a href="{{ url_for('admin_pedidos') }}" class="tab {{ 'active' if not status_atual else '' }}">Todos</a>
        <a href="{{ url_for('admin_pedidos', status='aguardando_pagamento') }}" class="tab {{ 'active' if status_atual == 'aguardando_pagamento' else '' }}">Aguardando Pagamento</a>
        <a href="{{ url_for('admin_pedidos', status='pago') }}" class="tab {{ 'active' if status_atual == 'pago' else '' }}">Pagos</a>
        <a href="{{ url_for('admin_pedidos', status='processando') }}" class="tab {{ 'active' if status_atual == 'processando' else '' }}">Processando</a>
        <a href="{{ url_for('admin_pedidos', status='enviado') }}" class="tab {{ 'active' if status_atual == 'enviado' else '' }}">Enviados</a>
        <a href="{{ url_for('admin_pedidos', status='entregue') }}" class="tab {{ 'active' if status_atual == 'entregue' else '' }}">Entregues</a>
    </div>
</div>

<div class="dashboard-card">
    <div class="card-body">
        {% if pedidos %}
        <table class="data-table full-width">
            <thead>
                <tr>
                    <th>Pedido</th>
                    <th>Data</th>
                    <th>Cliente</th>
                    <th>Total</th>
                    <th>Pagamento</th>
                    <th>Status</th>
                    <th>AÃ§Ãµes</th>
                </tr>
            </thead>
            <tbody>
                {% for pedido in pedidos %}
                <tr>
                    <td data-label="Pedido"><strong>#{{ pedido.id }}</strong></td>
                    <td data-label="Data">{{ pedido.data|format_date }}</td>
                    <td data-label="Cliente">
                        {{ pedido.cliente_nome or pedido.nome_cliente }}<br>
                        <small>{{ pedido.email }}</small>
                    </td>
                    <td data-label="Total"><strong>{{ pedido.total|format_price }}</strong></td>
                    <td>
                    {% if pedido.status_pedido in ['pago', 'processando', 'enviado', 'entregue'] %}
                    <span class="status-badge status-aprovado">
                        Aprovado
                    </span>
                    {% elif pedido.status_pedido == 'aguardando_pagamento' %}
                    <span class="status-badge status-pendente">
                        Pendente
                    </span>
                    {% else %}
                    <span class="status-badge status-{{ pedido.status_pagamento or 'pendente' }}">
                        {{ pedido.status_pagamento or 'Pendente' }}
                    </span>
                    {% endif %}
                </td>
                <td>
                    <span class="status-badge status-{{ pedido.status_pedido }}">
                        {{ pedido.status_pedido|replace('_', ' ')|title }}
                    </span>
                </td>
                    <td data-label="AÃ§Ãµes">
                        <a href="{{ url_for('admin_pedido_detalhe', id=pedido.id) }}" class="btn btn-sm btn-outline">Ver Detalhes</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p class="empty-text">Nenhum pedido encontrado.</p>
        {% endif %}
    </div>
</div>
{% endblock %}